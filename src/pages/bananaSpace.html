<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Banana Invaders</title>
    <style>
        body {
            /* Usamos el color de tu fondo propuesto */
            background-color: #2A2A40;
            color: white;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            margin: 0;
            font-family: 'Courier New', Courier, monospace;
            overflow: hidden; /* Para que no salgan barras de scroll */
        }
        canvas {
            border: 4px solid #3E3E5E; /* Borde del color de los pl谩tanos */
            background-color: #000; /* Fondo negro para el juego retro */
            box-shadow: 0 0 20px rgba(0,0,0,0.5);
        }
        h1 { margin-bottom: 10px; font-size: 20px; }
        p { margin-top: 5px; font-size: 14px; color: #aaa; }
    </style>
</head>
<body>

    <h1> BANANA INVADERS </h1>
    <canvas id="gameCanvas" width="480" height="320"></canvas>
    <p>Usa las FLECHAS para moverte y ESPACIO para disparar</p>

    <script>
        const canvas = document.getElementById("gameCanvas");
        const ctx = canvas.getContext("2d");

        // Variables del juego
        let score = 0;
        let gameOver = false;

        // JUGADOR (La Nave)
        const player = {
            x: canvas.width / 2 - 15,
            y: canvas.height - 30,
            w: 30,
            h: 10,
            color: '#00ff00',
            speed: 5,
            dx: 0
        };

        // BALAS
        const bullets = [];
        const bulletSpeed = 7;

        // ENEMIGOS (Los Invasores)
        const enemies = [];
        const enemyRows = 3;
        const enemyCols = 8;
        const enemyW = 30;
        const enemyH = 20;
        const enemyPadding = 15;
        const enemyOffsetTop = 30;
        const enemyOffsetLeft = 30;
        let enemyDx = 1; // Velocidad horizontal
        let enemyDy = 0; // Velocidad vertical (bajada)

        // Crear enemigos iniciales
        function createEnemies() {
            for(let c=0; c<enemyCols; c++) {
                for(let r=0; r<enemyRows; r++) {
                    let enemyX = (c * (enemyW + enemyPadding)) + enemyOffsetLeft;
                    let enemyY = (r * (enemyH + enemyPadding)) + enemyOffsetTop;
                    enemies.push({ x: enemyX, y: enemyY, status: 1 });
                }
            }
        }
        createEnemies();

        // CONTROLES
        document.addEventListener("keydown", keyDownHandler);
        document.addEventListener("keyup", keyUpHandler);

        function keyDownHandler(e) {
            if(e.key == "Right" || e.key == "ArrowRight") player.dx = player.speed;
            else if(e.key == "Left" || e.key == "ArrowLeft") player.dx = -player.speed;
            else if(e.key == " " || e.code == "Space") {
                bullets.push({ x: player.x + player.w / 2 - 2, y: player.y, w: 4, h: 10 });
            }
        }

        function keyUpHandler(e) {
            if(e.key == "Right" || e.key == "ArrowRight" || e.key == "Left" || e.key == "ArrowLeft") {
                player.dx = 0;
            }
        }

        // BUCLE PRINCIPAL DEL JUEGO
        function draw() {
            if (gameOver) {
                ctx.font = "30px Arial";
                ctx.fillStyle = "white";
                ctx.textAlign = "center";
                ctx.fillText("GAME OVER", canvas.width/2, canvas.height/2);
                ctx.font = "15px Arial";
                ctx.fillText("Recarga la p谩gina para jugar", canvas.width/2, canvas.height/2 + 30);
                return;
            }

            // Limpiar pantalla
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // 1. DIBUJAR JUGADOR
            ctx.fillStyle = player.color;
            ctx.fillRect(player.x, player.y, player.w, player.h);

            // Mover jugador
            player.x += player.dx;
            // L铆mites de pantalla
            if (player.x < 0) player.x = 0;
            if (player.x + player.w > canvas.width) player.x = canvas.width - player.w;

            // 2. DIBUJAR BALAS
            ctx.fillStyle = "yellow";
            bullets.forEach((b, index) => {
                ctx.fillRect(b.x, b.y, b.w, b.h);
                b.y -= bulletSpeed;
                // Eliminar balas que salen de la pantalla
                if (b.y < 0) bullets.splice(index, 1);
            });

            // 3. DIBUJAR ENEMIGOS
            let edgeTouched = false;
            
            enemies.forEach((e) => {
                if(e.status == 1) {
                    // Dibujamos un rect谩ngulo (puedes cambiarlo por una imagen de pl谩tano)
                    ctx.fillStyle = "#FF00FF"; // Morado ne贸n
                    ctx.fillRect(e.x, e.y, enemyW, enemyH);
                    
                    // Movimiento
                    e.x += enemyDx;

                    // Colisi贸n con paredes
                    if(e.x + enemyW > canvas.width || e.x < 0) {
                        edgeTouched = true;
                    }

                    // Colisi贸n bala vs enemigo
                    bullets.forEach((b, bIndex) => {
                        if(b.x > e.x && b.x < e.x + enemyW && b.y > e.y && b.y < e.y + enemyH) {
                            e.status = 0; // Enemigo muerto
                            bullets.splice(bIndex, 1); // Eliminar bala
                            score++;
                        }
                    });
                    
                    // Game Over si tocan al jugador
                    if (e.y + enemyH >= player.y) gameOver = true;
                }
            });

            // Si un enemigo toca el borde, todos bajan y cambian de direcci贸n
            if(edgeTouched) {
                enemyDx = -enemyDx;
                enemies.forEach(e => e.y += 10);
            }

            // Puntuaci贸n
            ctx.fillStyle = "#FFF";
            ctx.font = "16px Arial";
            ctx.fillText("Puntos: " + score, 8, 20);

            requestAnimationFrame(draw);
        }

        draw();
    </script>
</body>
</html>